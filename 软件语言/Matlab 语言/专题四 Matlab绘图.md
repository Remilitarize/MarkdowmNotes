[toc]

## 二维曲线

### plot 函数

- 一般调用格式：``plot(x, y)`
    - 当 `x` 和 `y` 都是 **向量** 时，向量长度必须相等。
    - 当 `x` 是向量，`y` 是矩阵时，
        - 如果 **矩阵 `y` 的列数等于 `x` 的长度**，则以向量 `x` 为横坐标，以 `y` 的每个行向量为纵坐标绘制曲线，曲线的条数等于 `y` 的行数。
        - 如果 **矩阵 `y` 的行数等于 `x` 的长度**，则以向量 `x` 为横坐标，以 `y` 的每个列向量为纵坐标绘制曲线，曲线的条数等于 `y` 的列数。
        - 当 `x` 和 `y` 是 **同型矩阵** 时，以 `x` 和 `y` 对应列元素为横、纵坐标分别绘制曲线，曲线条数等于矩阵的列数。
- 最简单调用格式：`plot(x)`
    - 当 `x` 是实数向量时，以元素的下标为横坐标，元素的值为纵坐标。
    - 当 `x` 是复数向量时，分别以该向量元素实部和虚部为横、纵坐标。
- 含多个输入参数的 `plot` 函数：
    - 格式：`plot(x1, y1, x2, y2, ..., xn, yn)`
    - 每一向量构成一组数据点的横、纵坐标，绘制一条曲线。
- 含选项的 `plot` 函数：`plot(x, y, 选项)`
    - 选项包括：线型、颜色、数据点标记
    - 线型包括：`'-'` 实线、`':'` 虚线、`'-.'` 点划线、`'--'` 双划线
    - 颜色包括：`'r'` 红色、`'g'` 绿色、`'b'` 蓝色、`'w'` 白色、`'k'` 黑色。
    - 数据点标记包括：`'*'` 星号、`'o'` 圆圈、`'s'` 方块、`'p'` 五角星、`'^'` 朝上三角符号

例：用不同线型和颜色在同意坐标内绘制曲线 $latex y = 2e^{-0.5x} \sin{2\pi x} $。

```matlab
x = (0:pi/50:2*pi);
y1 = 2*exp(-0.5*x) * [-1, 1];
y2 = 2*exp(-0.5*x) .* sin(2*pi*x);
x1 = 0:0.5:6;
y3 = 2*exp(-0.5*x) .* sin(2*pi*x1);
plot(x, y1, 'k:', x, y2, 'b--', x1, y3, 'rp');
```

例：绘制函数 $latex \sin{\frac{1}{x}} $ 的图形。

```matlab
x = 0:0.005:0.2;
y = sin(1/x);
plot(x, y);
```

### fplot 函数

`fplot` 函数可以根据参数函数的变化特性，自适应地设置采样间隔大小。

- 调用格式：`fplot(f, lims, 选项)`
    - `f` 是一个函数句柄。
    - `lims` 是 x 轴的取值范围，用二元向量 `[xmin, xmax]` 描述。
        - 默认值为 `[-5, 5]`。
    - 选项的定义与 `plot` 函数相同。
    - 当数据点过于密集时，不建议使用数据点标记绘制曲线。
- 双输入函数参数的调用格式：`fplot(funx, funy, tlims, 选项)`
    - `funx` 和 `funy` 代表函数，通常采用函数句柄的格式。
    - `tlims` 为参数函数 `funx` 和 `funy` 的自变量的取值范围。

例：绘制函数 $latex \sin{\frac{1}{x}} $ 的图形。

```matlab
fplot(@(x) sin(1/x), [0, 0.2], 'b');
```

## 绘制图形的辅助操作

### 图形标注

- 添加标题：`title(图形标题)`
    - 添加多行标题时，将多个标题用大括号 `{}` 括起来，每个标题之间用逗号 `,` 隔开。
    - 允许使用 LaTeX 格式控制符。
        - 定义字体样式 `\bf` 加粗、`\it` 斜体、`\rm` 正体。
    - 例：`title({\bf 'x = sin{\omega}t' 'y = cos{\omega}t'})`
    - 含属性设置的 `title` 函数：`title(图形标题, 属性名, 属性值)`
        - 属性名和属性值要成对出现。
        - `Color` 属性：设置图形标题文本的颜色。例：`title('y=cos{\omega}t', 'Color', 'r')`
            - 省略时默认值为黑色。
        - `FontSize` 属性：设置图形标题文字的字号，例：`title(y=cos{\omega}t', 'FontSize', 24)`
            - 省略时默认值为 11。
- 添加坐标轴说明：`xlabel(x 轴说明)`/`ylabel(y 轴说明)`
- 跟随光标说明：`gtext(说明)`
    - 说明十字光标跟随鼠标移动，单击后放置。
  在指定位置添加说明：`text(x, y, 图形说明)`
  添加图例：`legend(图例1, 图例2, ...)`
  
### 坐标控制

- `axis` 函数：指定坐标范围。
    - 格式：`axis(xmin, xmax, ymin, ymax, zmin, zmax)`
    - 其他用法：
        - `axis equal`：横、纵坐标轴采用等长刻度。
        - `axis square`：产生正方形坐标系（默认为矩形）。
        - `axis auto`：使用默认设置。
        - `axis off`：取消坐标轴。
        - `axis on`：显示坐标轴。
- 添加网格：`grid` 命令
    - `grid on` 显示网格线。
    - `grid off` 不显示网格线。
    - `grid` 在上面两种状态之间切换。
    - 默认不显示网格线。
- 添加边框：`box` 命令
    - `box on` 显示边框
    - `box off` 不显示边框
    - `box` 在上面两种状态之间切换。
    - 默认显示边框。

### 图形保持

默认绘制新的图形时，原图形将被覆盖。
使用 `hold` 命令保持原有图形。

- `hold on`：保持原有图形。
- `hold off`：刷新原有图形。
- `hold`：在两种状态之间切换。

### 图形窗口的分割

子图：同一窗口中不同坐标系下的图形称为子图。

使用 `subplot` 函数将图形窗口分割为多个子图。

- 格式：`subplot(m, n, p)`
- `m` 和 `n` 指定将图形窗口分成 m\*n 个 绘图区。
- `p` 指定当前活动区，按行优先编号。

```matlab
x = linspace(0, 2*pi, 60);
subplot(2, 2, 1);
plot(x, sin(x)-1);
title('sin(x)-1');
axis([0 2*pi -2 0]);
subplot(2, 1, 2);
plot(x, cos(x)+1);
title('cos(x)+1');
axis([0 2*pi 0 2]);
subplot(4, 4, 3);
plot(x, tan(x));
title('tan(x)');
axis([0 2*pi -40 40]);
subplot(4, 4, 8);
plot(x, cot(x));
title('cot(x)');
axis([0 2*pi -35 35]);
```

## 其他形式的二维曲线

### 其他坐标系下的二位曲线图

- 对数坐标图
    - 半对数（x 为对数轴）：`semilogx(x1, y1, 选项1, x2, y2, 选项2, ...)`
    - 半对数（y 为对数轴）：`semilogy(x1, y1, 选项1, x2, y2, 选项2, ...)`
    - 全对数（x、y 均为对数轴）：`loglog(x1, y1, 选项1, x2, y2, 选项2, ...)`
- 极坐标图
    - `polar(theta, rho, 选项)`

### 统计图

- 条形图
    - 垂直条形图
        - 一般调用格式：`bar(y, style)`
            - `y` 是数据。
            - `style` 用于指定分组排列模式。
                - `grouped` 簇状分组、`stacked` 堆积分组
                - 默认采用簇状分组。
        - 其他调用格式：`bar(x, y, style)`
            - `x` 存储横坐标，`y` 存储数据。
    - 水平条形图：`barh`
- 直方图
    - 直角坐标系
        - 一般调用格式：`hist(y)`
        - 其他调用格式：`hist(y, x)`
            - `y` 是要统计的数据，`x` 用于指定区间的划分方式。
            - 将 `y` 中最小值和最大值的数值区间等分。
            - `x` 缺省时默认按 10 个等分区间统计。
    - 极坐标系：`rose(theta, x)`
        - `theta` 用于确定每一区间与原点的角度，单位为弧度。
        - `x` 用于指定区间的划分方式。
        - `x` 缺省时默认按 20 个等分区间统计。 
- 饼图
    - 格式：`pie(x, explode)`
    - 参数 `x` 存储待统计数据。
    - 选项 `explode` 控制图块的显示模式，且与 `x` 等长。
        - 值为 1 时扇形从中心分离，值为 0 时不变。
    - `explode` 缺省时是饼图一个整体。
- 面积图
    - 格式：`area(x)`

### 散点类图形

- 散点图 `scatter`
    - 格式：`scatter(x, y, 选项, 'filled')`
    - `x`、`y` 用于定位数据点。
    - 选项用于指定线型、颜色、数据点标记。
    - `filled` 表示数据点实心显示。
- 阶梯图`stairs`
- 杆图 `stem`

> 调用格式与 `plot` 类似。

### 矢量类图形

- 罗盘图 `compass`
- 羽毛图 `feather`
- 箭头图 `quiver`
    - 格式：`quiver(x, y, u, v)`
    - `x`、`y`、`u`、`v` 为大小相等的向量。
    - `x`、`y` 表示矢量起点。
    - `u`、`v` 表示矢量终点。

> 调用格式与 `plot` 类似。

## 三维曲线

- `plot3` 函数
    - 格式：`plot3(x, y, z)`
    - 格式：`plot3(x1, y1, z1, x2, y2, z2, ..., xn, yn, zn)`

例：在空间不同位置绘制 5 条正弦曲线。

```matlab
t = 0: 0.02: 2*pi;
t = t';
x = [t t t t t];
y = [sin(t), sin(t)+1, sin(t)+2, sin(t)+3, sin(t)+4];
z = [t t t t t];
plot3(x, y, z);
```

等价于

```matlab
t = 0: 0.01: 2*pi;
y = [sin(t); sin(t)+1; sin(t)+2; sin(t)+3; sin(t)+4];
plot3(t, y, t);
```

- `fplot3` 函数
    - 格式：`fplot3(funx, funy, funz, tlims);`
    - `fplot3(funx, funy, funz, tlims, 选项);`

例：绘制墨西哥冒顶曲线，曲线的参数方程如下：

\begin{cases}
x &= e^{\frac{-t}{10}}\sin{5t} \\\\
y &= e^{\frac{-t}{10}}\cos{5t} \\\\
z &= t
\end{cases}

其中，$latex t \in \[-12, 12\] $。

```matlab
xt = @(t) exp(-t/10).*sin(5*t);
yt = @(t) exp(-t/10).*cos(5*t);
zt = @(t) t;
fplot3(xt, yt, zt, [-12, 12]);
```

## 三维曲面

### 平面网格矩阵的生成

***利用矩阵运算生成***

```matlab
x = 2: 6;
y = (3: 8)';
X = ones(size(y)) * x;
Y = y * ones(size(x));
```

***利用 `meshgrid` 函数生成***

- 格式：`[X, Y]` = meshgrid(x, y)`
- 若 `x`、`y` 相同时，可写作 `meshgrid(x)`。

```matlab
x = 2: 6;
y = (3: 8)';
[X, Y] = meshgrid(x, y);
```

### 绘制三维曲面的函数

***一般调用格式***

- 三维网格图：`mesh(x, y, z, c)`
- 三维曲面图：`surf(x, y, z, c)`
- `x`、`y` 是网格坐标矩阵。
- `z` 是网格点上的高度矩阵、
- `c` 用于指定不同高度下的曲面颜色。

例：绘制三维曲面图 $latex z = xe^{-x^2 - y^2} $。

```matlab
t = -2: 0.2: 2;
[X, Y] = meshgrid(t);
Z = X .* exp(-X.^2 - Y.^2);
subplot(1, 3, 1);
mesh(X, Y, Z);
subplot(1, 3, 2);
surf(X, Y, Z);
subplot(1, 3, 3);
plot3(X, Y, Z);
grid on
```

- `mesh` 函数绘制的线条有颜色，线条间补面无颜色 。
- `surf` 函数绘制的线条是黑色，线条间补面有颜色。
- `plot3` 函数由三维曲线组合而成。

***其他调用格式***

- `mesh(z, c)`
- `surf(z, c)`
- 当 `x` 和 `y` 省略时，`z` 矩阵的第 2 维下标当作 x 轴坐标，`z` 矩阵的第 1 维下标当作 y 轴坐标。

### 其他三维曲面函数

- 带等高线的三维网格曲面函数 `meshc`
- 带底座的三维网格曲面函数 `meshz`
- 具有等高线的曲面函数 `surfc`
- 据哟光照效果的曲面函数 `surfl`

### 标准三维曲面

- 三维球面：`[x, y, z] = sphere(n)`
    - 产生三个 n+1 阶方阵。 
    - 可以绘制出圆心位于原点，半径为 1 的单位球体。
    - 参数 `n` 决定了球面的圆滑程度，默认为 20。
        - 若 `n` 较小，将产生多面体。
- 三维柱面：`[x, y, z] = cylinder(R, n)`
    - `R` 是向量，存放柱面各个等间隔高度的半径。
    - `R` 是标量，则标准标准柱面。
    - 参数 `n` 决定了柱面的圆滑程度，默认为 20.

例：用 `cylinder` 函数绘制两个相互垂直且直径相等的圆柱面的相交图形。

```matlab
[x, y, z] = cylinder(1, 60);
z = [-1 * z(2, :); z(2, :)];
surf(x, y, z);
hold on
serf(y, z, x);
axis equal
```

- 多峰函数曲面图 `peaks()`
  
### `fsurf` 函数和 `fmesh` 函数

- `fsurf(funx, funy, funz, uvlims)`
- `fmesh(funx, funy, funz, uvlims)`
- 其中，`uvlims` 表示自变量的取值范围，用 4 元向量表示。

## 图形修饰处理

### 视点处理

- 方位角
    - 视点与原点连线在 xy 平面上的投影，与 y 轴负方向夹角。
    - 正值表示逆时针，负值表示顺时针。
- 仰角
    - 视点与原点连线，与 xy 平面的夹角。
    - 正值表示在 xy 平面上方，负值表示在 xy 平面下方。

***一般调用格式***

格式：`view(az, el)`
其中，`az` 为方位角，`el` 为仰角，单位为度。
默认方位角为 $latex -37.5^{\circ} $，仰角为 $latex 30^{\circ} $。

***其他调用格式***

- `view(x, y, z)`：视点在笛卡尔坐标中的位置。
- `view(2)`：从二维平面观察图形。
    - 方位角为 $latex 0^{\circ} $，仰角为 $latex 90^{\circ} $。
- `view(3)`：从三维平面观察图形。
    - 方位角和仰角为默认值。

### 色彩处理

- 颜色的向量表示
    - `(R, G, B)`：红黄蓝
    - 取值范围均为 0 ~ 1。
- 色图
    - 色图矩阵：`colormap()`
    - 内建色图：冷暖色图、四季色图、灰度色图等
    - 默认使用 `parula` 色图。
    - 指定当前图形使用的色图：`colormap 色图名`
    - 创建色图矩阵：
  
```matlab
c = [0 0.2 0.4 0.6 0.8 1]';
cmap = [c, c, c];        % 等价于 cmap = gray(6)
surf(peaks);
colormap(cmap)
```

- 三维图形表面的着色
    - `shading faceted`：将每个网格片用其高度对应的颜色进行着色，网格线是黑色。
        - 系统默认着色。
    - `shading flat`：将每个网格片用同一个颜色进行着色，且网格线也用相应的颜色。
    - `shading interp`：在网格片内采用颜色插值处理。

### 图形的裁剪处理

将图形中需要裁剪部分对应的函数值设置成 `NaN`，在绘制图形时，函数值为 `NaN` 的部分将不显示出来，从而达到对图形进行裁剪的目的。

## 交互式绘图工具

### "绘图" 选项卡

- 左侧所选内容命令组显示已选中的绘图变量。
- 中间绘图命令组显示用于绘图的命令。
- 右边选项命令组用于选择是否重建绘图界面。

> 注意选中变量的顺序。

### 图形窗口绘图工具

- 显示绘图工具
    - 图形窗口打开时，默认不显示绘图工具。
    - 单击 "显示绘图工具和停靠图形" 按钮。
    - 输入命令：`plottools`
- 绘图工具的组成
    - 图形选项板
        - 新子图面板：添加二维、三维子图
        - 变量面板：浏览、选择绘图数据
        - 注释面板：为图形添加标注。
    - 绘图浏览器
    - 属性编辑器

### 图形窗口菜单和工具栏

略
