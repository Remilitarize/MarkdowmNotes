[toc]

## 课前内容

利用计算机处理数值问题的方法，称为 **科学计算**。

MATLAB —— **MAT**rix **LAB**oratory

例如：求 $latex x^2 - 3x + 1 = 0$ 的根。

- 求根公式 `roots`：

```matlab
p = [1 -3 1];
x = roots(p)
```

> 通过绘图功能，可知方程解大致在 0.5 和 2.5 附近。
> ```matlab
> x = -5 : 0.1 : 5;
> y1 = x.*x + - 3 * x + 1;
> y2 = zeros(size(x));
> plot(x, y1, x, y2)
> ```

- 单变量非线性方程根函数 `fzero`：

```matlab
f = @(x) x*x - 3*x + 1;
x1 = fzero(f, 0.5)
x2 = fzero(f, 2.5)
```

- 方程求根函数 `fsolve`：

```matlab
f = @(x) x*x - 3*x + 1;
x1 = fsolve(f, 0.5, optimset('Display', 'off'))
x2 = fsolve(f, 2.5, optimset('Display', 'off'))
```

- 求方程符号解 `solve`：

```matlab
syms x
x = solve(x^2 - 3*x + 1);
x = eval(x)
```

## Matlab 系统环境

### Matlab 工作环境

![Matlab 工作环境](http://oxnec2zdn.bkt.clouddn.com/matlab/matlabgongzuohuanjing.PNG)

- Matlab 主窗口
    - 功能区
    - 快速访问工具栏
    - 当前文件夹工具栏
- 命令行窗口
    - 用于输入命令并显示命令的执行结果。
    - 当命令过长时，可使用 `...` 换行符另起一行继续输入命令。
- 当前文件夹窗口
    - 设置当前文件夹方法：
        - 在当前文件夹工具栏或当前文件夹窗口中选择某文件夹为当前文件夹。
        - 使用 `cd` 命令在命令栏中选择。例：`cd e:/MatlabWorkspace`。
    - 一定要 **先建立文件夹**，再将这个文件夹设为当前文件夹。
- 工作区窗口
    - 显示当前工作环境中的变量以及其值、最大值、最小值等。

### Matlab 搜索路径

命令对象的搜索路径如下：

1. 变量
2. 内部函数
3. 程序文件
    1. 当前文件夹下的程序文件
    2. 文件搜索路径文件夹中的程序文件

下面代码中的 x 的值不一样：

```matlab
clear;
x = sin(1)
sin = [1 2 3 4 5];
x = sin(1)
```

设置搜索路径：

1. 使用 `path` 命令设置文件搜索路径。
    - `path(path, 'e:/MatlabWorkspace');`
2. 用对话框设置。
   
## Matlab 数值数据

### 数值数据的分类

- 整型（每一种分别包含 8 位、16 位、32 位、64 位）
    - 无符号整数
        - 二进制位的所有位均用于表示数值。
    - 带符号整数
        - 二进制位的第一位用于表示符号，其余位用于表示数值。
    - 转换函数
        - `int8()`：转换为带符号 8 位整数。
        - `uint8()`：转换为无符号 8 位整数。
- 浮点数
    - 单精度：占用 4 个字节。
    - 双精度：占用 8 个字节。（默认）
    - 转换函数：
        - `single()`：转换为单精度浮点数。
        - `double()`：转换为双精度浮点数。

> 使用 `class()` 得到数据的类型。

- 复型
    - 包括 **实部** 和 **虚部** 两个部分。
    - 默认为双精度类型。
    - 虚数单位用 `i` 或 `j` 表示。
    - `real()`：求复数的实部。
    - `imag()`：求复数的虚部。

### 数值数据的输出格式

`format` 命令：`format 格式符`。

```matlab
format long
50/3           % 输出小数点后 15 位

format         % 等价于 format short
50/3           % 输出小数点后 4 位
```

> `format` 只影响输出格式，不影响存储及计算。

### 常用数学函数

函数的调用格式：
`函数名(函数自变量的值)`

- 函数自变量的值固定为 **矩阵变量**（标量是一种特殊的矩阵变量）。
- 函数在运算时是将函数逐项作用于矩阵的每个元素上。

```matlab
A = [1 2; 3 4];
B = exp(A)
```

注意：

- 三角函数有以弧度为单位的函数和以角度为单位的函数。
    - 以 **角度** 为单位的函数其函数名的结尾多一个 `d`。
    - 例：`sin()` 以弧度为单位，`sind()` 以角度为单位。
- `abs()` 可以求：
    - 实数的绝对值
    - 复数的模
    - 字符串的 ASCII 码。
- 取整函数有以下几种：
    - `round()` 函数按照 **四舍五入** 的规则取整。
    - `ceil()` 函数 **向上取整**，大于等于这个数的的一个整数。
    - `floor()` 函数 **向下取整**，小于等于这个数的一个整数。
    - `fix()` 函数 **舍弃小数点取整**。

### 函数应用举例

分别求一个三位正整数的个位数字、十位数字和百位数字。

> 求余函数有 `rem()` 或 `mod()`。

```matlab
m = 345;

m1 = rem(m, 10)

m2 = rem(fix(m / 10), 10)

m3 = fix(m / 100)
```

求 [1, 100] 区间的所有素数。

> 使用 `isprime()` 判断是否是素数。

```matlab
x = 1 : 100;
k = isprime(x);
k1 = find(k);     % 生成所有非零元素的序号
p = x(k1)
```

## 变量及其操作

### 变量与赋值语句

变量名是以 **字母** 开头，后接字母、数字、下划线的字符序列。
最多 63 个字符。

- 变量名区分大小写。
- 标准函数名以及命令名必须用小写字母。

赋值语句的两种形式：

- `变量 = 表达式`
- `表达式`
    - 将表达式的值赋值给预定义变量 `ans`。

> 当以分号 `;` 结尾时，将仅进行赋值操作，不会将结果显示出来。

### 预定义变量

预定义变量是由系统本身定义的变量。

- `ans` 是默认变量。
- `i` 和 `j` 代表虚数单位。
- `pi` 代表圆周率。
- `NaN` 代表非数。

### 变量的管理

内存变量的删除与修改：

- 在工作区中进行变量的操作。
- `who` 与 `whos` 命令
    - `who` 命令仅显示变量名。
    - `whos` 命令显示变量名、值、类型、大小。
- 使用 **内存变量文件**。
    - 内存变量文件用于保存 Matlab 工作区变量的文件。
    - 扩展名为 `.mat`。
    - `save` 命令：创建内存变量文件。
        - 例：`save mydata a x  % 将变量 a 和 x 保存在 mydata.mat 中`
    - `load` 命令：载入内存变量文件。
        - 例：`load mydata`

## Matlab 矩阵的表示

### 矩阵的建立

- 直接输入法建立矩阵：
    - 矩阵的元素用 **中括号** 括起来。
    - 按矩阵行的顺序输入各元素。
    - 同一行的个元素之间用 **逗号或空格** 分隔。
    - 不同行的元素之间用 **分好** 分隔。
  
```matlab
A = [1 2 3; 4, 5, 6; 7 8, 9]
```

- 用已建好的矩阵建立更大的矩阵：
    - 一个大局真可以由已经建立好的小矩阵拼接而成。

```matlab
A = [1 2 3; 4 5 6; 7 8 9];
B =[-1, -2, -3; -4, -5, -6; -7, -8, -9];
C = [A B; B A] 
```

- 对于复数矩阵，可以用实部矩阵和虚部矩阵构成。

```matlab
A = [1 2 3; 4 5 6];
B = [6 5 4; 3 2 1];
C = A + B * j
```

### 冒号表达式

一般格式为：
`e1 : e2 : e3`

- `e1`：初始值
- `e2`：步长，省略时默认为 1。
- `e3`：终止值。

```matlab
A = 1 : 3 : 10
A = [1 : 3 : 10]
A = (1 : 3 : 10)
```

线性差分函数：
`linspace(a, b, n)`

- `a`：第 1 个元素。
- `b`：最后一个元素。
- `n`：元素总数，省略时默认为 100。

### 结构矩阵和单元矩阵

- 结构矩阵
    - 由 **结构数据** 构成的矩阵称为结构矩阵。
    - 格式：`结构矩阵元素.成员名 = 表达式`。

```matlab
a(1).x1 = 10; a(1).x2 = 'liu'; a(1).x3 = [11 12; 13 14];
a(2).x1 = 12; a(2).x2 = 'wang1; a(2).x3 = [34 101; 25 332];
a(3).x1 = 14; a(3).x2 = 'cal'; a(3).x3 = [16 442; 45 342];
```

- 单元矩阵
    - 用直接输入法建立单元矩阵。
    - 单元矩阵元素用 **大括号 `{}`** 括起来。

```matlab
b = {10 'liu' [11 12; 13 14]; ...
     23 'wang' [32 54; 65 12]}
```

## 矩阵元素的引用

### 矩阵元素的引用方式

- 通过 *下标* 引用
    - `A(3, 2)` 表示 A 矩阵第 3 行第 2 列的元素。
    - 如果引用超出范围，系统将会报错。
    - 但如果给超出范围的下标位置上的元素赋值，系统将自动扩展原来的矩阵，并将其余扩展后没有赋值的矩阵元素置为 0。

```matlab
A = [1 2 3; 4 5 6];
A(4, 5) = 10
```

- 通过 *序号* 引用：
    - 在 Matlab 中，矩阵元素按 **列** 存储。
    - 矩阵元素的序号就是矩阵元素在内存中的排列顺序。
    - 设矩阵 A 为 m &times; n 矩阵，则第 i 行第 j 列的元素的序号为 `(j-1) * m + i`。
  
`sub2ind` 函数：将矩阵中指定元素的行、列下标转换成存储的序号。
格式：`D = sub2ind(S, I, J)`

- `D`：返回结果，即序号。
- `S`：行数和列数组成的向量，一般使用 `size()` 函数获取。
- `I`：转换矩阵的行下标（向量）。
- `J`：转换矩阵的列下标（向量）。
  
```matlab
A = [1 : 3; 4 : 6];
D = sub2ind(size(A), [1 2: 2 2], [1 1; 3 2])
```

`ind2sub` 函数：将把矩阵元素的序号转换成对应的下标。
格式：`[I, J] = ind2sub(S, D)`

- `I`：行下标。
- `J`：列下标。
- `S`：行数和列数组成的向量，一般使用 `size()` 函数获取。
- `D`：序号（向量）。

```matlab
[I, J] = ind2sub([3 3], [1 3 5])
```

### 利用冒号表达式获得子矩阵

- `A(i, :)`：第 i 行的全部元素。
- `A(:, j)`：第 j 列的全部元素。
- `A(i : i+m, j : j+n)`：第 i ~ i+m 行内且第 j ~ j+n 列中的所有元素。
- `A(i : i+m, :)`：第 i ~ i+m 行的全部元素。

`end` 运算符：表示某一为的末尾元素下标。

- `A(:, end)`：最后一列全部元素。

### 利用空矩阵删除矩阵的元素

*空矩阵* 是指没有任何元素的矩阵。
`x = []`

```matlab
A = [1 2 3 0 0; 7 0 9 2 6; 1 4 -1 -1 8];
A(:, [2 3]) = []
```

### 改变矩阵形状

`reshape(A, m, n)`：在矩阵总元素保持不变的前提下，将矩阵 A 重新拍成 m &times; n 的二维矩阵。
注意：`reshape()` 函数只改变原矩阵的行数和列数，但并不改变原矩阵元素个数及其存储顺序。

`A(:)`：将矩阵 A 的每一列元素堆叠起来，成为一个列向量。

## Matlab 基本运算

### 算术运算

- `+`：加
- `-`：减
- `*`：乘
- `/`：右除
- `\`：左除
- `^`：乘方

注意：算术运算均是在 *矩阵* 意义下进行的。

***加减运算***

- 若两矩阵同型，则运算时两矩阵的对应元素相加减。
- 若两矩阵不同型，则系统给出错误信息。
- 一个标量与矩阵相加减，则将 *标量与矩阵的每个元素相加减*。

**乘法运算**

- 若 A 的列数与 B 的行数相等，则称矩阵 A、B 是 *可乘的*，或称矩阵 A、B 两矩阵维数和大小 *相容*。
- 如果两矩阵的维数或大小不相容，则系统给出错误信息。

***除法运算***

- 如果 A 矩阵是 *非奇异方阵*，
    - `B/A` 等效于 `B * inv(A)`。
    - `A/B` 等效于 `inv(A) * B`。
- 对于两标量或一矩阵一标量相除，`a/b` 等效于 `b/a`。

***乘方运算***

一个矩阵的乘方运算可以表示成 `A^x`，要求 A 为 *方阵*，x 为 *标量*。

***点运算***

- `.*`：两矩阵对应元素相乘。
- `./`：左矩阵的元素除以右矩阵的对应元素。
- `.\`：右矩阵的元素除以左矩阵的对应元素。
- `.^`：左矩阵的元素以右矩阵对应元素为幂做乘方运算。

### 关系运算

- `<`：小于
- `<=`：小于等于
- `>`：大于
- `>=`：大于等于
- `==`：等于
- `~=`：不等于

比较法则：

- 当两个比较量为标量时，直接比较两数的大小。
    - 关系成立，表达式结果为 1。
    - 关系不成立，表达式结果为 0。
- 当两个比较量为两个 *同型* 矩阵时，对应位置的元素按标量进行比较。
    - 最终结果是一个与原矩阵同型的矩阵。
- 当两个比较量分别为一个矩阵和一个标量时，矩阵的每一个元素与标量按标量进行比较。
    - 最终结果是一个与原矩阵同型的矩阵。

### 逻辑运算

- `&`：与
- `|`：或
- `~`：非

运算法则：

- `a & b`：a、b 全为非零时，运算结果为 1，否则为 0。
- `a | b`：a、b 有一个为非零时，运算结果为 1。
- `~a`：a 为 0 时，结果为 1。

> 矩阵的逻辑运算形式上与关系运算类似。

## 字符串处理

### 字符串的表示

字符串使用 **单引号** 或 **双引号** 括起来的字符序列。

- 当字符串中的字符含有单引号时，*使用两个单引号来表示一个单引号*。
- 字符串可以看作一个行向量。

### 字符串的操作

- 字符串的执行：`eval(s)`
    - 将字符串 `s` 转换成相应的命令并执行。
- 转换函数
    - `abs()` 和 `double()` 函数都可以用来获取字符串矩阵所对应的 ASCII 码数值矩阵。
    - `char()` 函数可以把 ASCII 码矩阵转换为字符串矩阵。
- 字符串的比较
    - 使用关系运算符：
        - 两个字符串中对应位置上的字符按 ASCII 值逐个比较。
        - 比较结果是一个 *数值向量*。
    - 使用字符串比较函数：
        - `strcmp(s1, s2)`：比较两个字符串是否相等，相等返回 1，否则返回 0。
        - `strncmp(s1, s2, n)`：比较两个字符串前 n 个字符是否相等。
        - `strcmpi(s1, s2)`：忽略大小写前提下，比较两个字符串是否相等。
        - `strncmpi(s1, s2)`：忽略大小写前提下，比较两个字符串前 n 个字符是否相等。
- 字符串的查找：`findstr(s1, s2)`
    - - 返回短字符串在长字符串中的开始位置。
- 字符串的替换：`strrep(s1, s2, s3)`
    - 将字符串 `s1` 中的所有子字符串 `s2` 替换为字符串 `s3`。
 