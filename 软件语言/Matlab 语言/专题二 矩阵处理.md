[toc]

## 特殊矩阵

### 通用性的特助矩阵

- `zeros` 函数：产生 *全 0 矩阵*，即 **零矩阵**。
- `ones` 函数：产生 *全 1 矩阵*，即 **幺矩阵**。
- `eye` 函数：产生 *对角线为 1 的矩阵*。
    - 当矩阵是方阵时，得到一个 *单位矩阵*。
- `rand` 函数：产生 *(0, 1) 区间均匀分布的随机矩阵*。
    - 注意不包括 0 和 1。
    - `fix(a+(b-a+1)*x)`：产生 [a, b] 区间上均匀分布的随机矩阵。
- `randn` 函数：产生 *均值为 0，方差为 1 的标准正态分布随机矩阵*。

调用格式：

> 以上函数的调用格式相似，仅以其中一个为例。

- `zeros(m)`：产生 m &times; m 的零矩阵。
- `zeros(m, n)`：产生 m &times; n 的零矩阵。
- `zeros(size(A))`：产生于矩阵 A 同样大小的零矩阵。

### 用于专门学科的特殊矩阵

**魔方矩阵**

 - 调用格式：`magic(m)`
- n 阶魔方阵由 1, 2, 3, ..., n<sup>2</sup> 共 n<sup>2</sup> 个整数组成。
- 每行、每列以及主、副对角线上各 n 个元素之和都相等。
- n 行魔方阵每行每列元素的和为 $latex \frac{n + n^3}{2} $。
- 当阶数大于 2 时，存在不同的魔方矩阵，Matlab 只产生一个特定的魔方阵。
  
**范德蒙矩阵**

- 对于向量 $latex v = [v_1, v_2, \cdots, v_n] $，范德蒙矩阵的一般形式如下：

$$ \left[
\begin{matrix}
v_1^{n-1} & \cdots & v_1^2 & v_1^1 & v_1^0 \\\\
v_2^{n-1} & \cdots & v_2^2 & v_2^1 & v_2^0 \\\\
v_3^{n-1} & \cdots & v_3^2 & v_3^1 & v_3^0 \\\\
\vdots & \ddots & \vdots & \vdots &\vdots \\\\
v_n^{n-1} & \cdots & v_n^2 & v_n^1 & v_n^0
\end{matrix}
\right]
$$

- 调用格式：`vander(v)`。
    - 例：`vander(1:5)`。

**希尔伯特矩阵**


- n 阶希尔伯特矩阵的一般形式为：

$$ \left[
\begin{matrix}
1 & \frac12 & \cdots & \frac1n \\\\
\frac12 & \frac13 & \cdots & \frac{1}{n+1} \\\\
\vdots & \vdots & \ddots & \vdots \\\\
\frac{1}{n} & \frac{1}{n+1} & \cdots & \frac{1}{2n-1}
\end{matrix}
\right]
$$

- 调用格式：`hilb(n)`
- **病态矩阵**，即任何一个元素发生较小的变动，整个矩阵的值和逆矩阵都会发生很大变化。
    - 随着阶数增加，病态更加严重。

> 为了显示更加直观，可以将输出格式设置为有理数。

```matlab
format rat
hilb(4)
```

**伴随矩阵**

- 设多项式 $latex p(x) $ 为 $latex a_n x^n + a_{n-1}x^{n-1} + \cdots + a_1 x + a_0 $，则该多项式的伴随矩阵是：

$$ \left[
\begin{matrix}
-\frac{a_{n-1}}{a_n} & -\frac{a_{n-2}}{a_n} & -\frac{a_{n-3}}{a_n} & \cdots & -\frac{a_1}{a_n} & -\frac{a_0}{a_n} \\\\
1 & 0 & 0 & \cdots & 0 & 0 \\\\
0 & 1 & 0 & \cdots & 0 & 0 \\\\
\vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\\\
0 & 0 & 0 & \cdots & 0 & 0 \\\\
1 & 0 & 0 & \cdots & 1 & 0
\end{matrix}
\right]
$$

- 调用格式：`compan(p)`。
    - `p` 是一个多项式的系数向量，高次幂系数排在前，低次幂系数排在后。

**帕斯卡矩阵**

- 根据二项式定理，$latex (x+y)^2 $ 展开后的系数随着 n 的增大组成一个三角形表，这个三角形称为 **杨辉三角形**。
- 把二项式系数依次填写在矩阵的 *左侧对角线* 上，然后提取左侧的 n 行 n 列元素即为 n 阶帕斯卡矩阵。

$$ \left[
\begin{matrix}
1 & 1 & 1 & 1 & 1 & 1 & 1 & 1 \\\\
1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 \\\\
1 & 3 & 6 & 10 & 15 & 21 & 28 & 36 \\\\
1 & 4 & 10 & 20 & 35 & 56 & 84 & 120 \\\\
1 & 5 & 15 & 35 & 70 & 126 & 210 & 330 \\\\
1 & 6 & 21 & 56 & 126 & 252 & 462 & 792 \\\\
1 & 7 & 28 & 84 & 210 & 462 & 924 & 1716 \\\\
1 & 8 & 36 & 120 & 330 & 792 & 1716 & 3432
\end{matrix}
\right]
$$

- 帕斯卡矩阵的第一行元素和第一列元素都为 1.
    - $latex P(i, 1) = P(1, j) = 1 $
- 其余位置的元素是该左边元素与上面元素之和。
    - $latex P(i, j) = P(i-1, j) + P(i, j-1) $
- 调用格式：`pascal(n)`

## 矩阵变换

### 对角阵

**对焦矩阵**：只有对角线上的有非零元素的矩阵。
**数量矩阵**：对角线上的元素相等的对焦矩阵。
**单位矩阵**：对角线上的元素都为 1 的矩阵。

- 提取矩阵的对角线元素：
    - `diag(A)`：提取矩阵 A 主对角线元素，产生一个列向量。
    - `diag(A, k)`：提取矩阵 A 第 k 条对角线的元素，产生一个列向量。

> 对角线的约定：主对角线为 0，与主对角线平行，向上为正，向下为负。

- 构造对角矩阵：
    - `diag(V)`：以向量 V 为主对角线元素，产生对角矩阵。
    - `diag(V, k)`：以向量 V 为第 k 对角线元素，产生对角矩阵。

对角阵的用途：左乘时行放大，右乘时列放大。

### 三角阵

**上三角阵**：矩阵的对角线以下的元素全为 0 的矩阵。
**下三角阵**：矩阵的对角阵以上的元素全为 0 的矩阵。

- 构造上三角阵：
    - `triu(A)`：提取矩阵 A 的主对角线及以上的元素。
    - `triu(A, k)`：提取矩阵 A 的第 k 条对角线及以上的元素。
- 构造下三角阵：
    - `tril(A)`：提取矩阵 A 的主对角线及以下的元素。
    - `tril(A, k)`：提取矩阵 A 的第 k 条对角线及以下的元素。

### 转置

**转置**：将矩阵的每一行依次转变为每一列。

- 转置运算符：`.'`
- 共轭转置运算符：`'`
    - 转置后取复共轭。
    - 如果是实数矩阵，转置与共轭转置的结果相同。

### 旋转

- `rot90(A, k)`：将矩阵 A **逆时针方向** 旋转 $latex 90^\circ $ 的 k 倍。
    - 当 k 为 1 时可省略。

 ### 翻转

 *左右翻转*：将矩阵第一列与最后一列调换，第二列与倒数第二列调换，以此类推。
 *上下翻转*：将矩阵第一行与最后一行调换，第二行与倒数第二行调换，以此类推。

 - `fliplr(A)`：对矩阵 A 实施左右翻转。
 - `flipud(A)`：对矩阵 A 实施上下翻转。

> 翻转可用于提取矩阵的副对角线。

### 求逆

**可逆**：对于一个方阵 A，如果存在一个与其同阶的方阵 B，使得 AB = BA = I（单位矩阵），则称 A 可逆。
其中，B 称为 A 的 **逆矩阵**。

- `inv(A)`：求方阵 A 的逆矩阵。

## 矩阵求值

### 矩阵的行列式值

把一个方阵看作一个行列式，并对其按行列式的规则求值，这个值就称为方阵所对应的行列式的值。

- `det(A)`：求方阵 A 所对应的行列式的值。

### 矩阵的秩

矩阵线性无关的行数或列数称为矩阵的秩。

- `rank(A)`：求矩阵 A 的秩。

例：求 3 - 20 阶魔方阵的秩。

```matlab
for i = 3 : 20
    r(i) = rank(magic(i));
end
bar(r)     %  绘制直方图
grid on
axis([2 21 0 20])
```

根据魔方阵的秩分为三类：

- 奇数阶魔方阵：秩为 n，即均为 *满秩矩阵*。
- 一重偶数阶魔方阵：秩为 $latex \frac{n}{2} + 2 $，其中 n 为 2 的倍数，不为 4 的倍数。
- 二重偶数阶魔方阵，秩均为 3，阶数是 4 的倍数。

### 矩阵的迹

矩阵的迹等于矩阵的对角线元素之和，也等于矩阵的特征值之和。

- `trace(A)`：求矩阵 A 的迹。
- 等价于 `sum(diag(A))`。

### 向量和矩阵的范数

矩阵或向量的范数用来度量矩阵或向量在某种意义下的长度。

向量的 3 种常用范数：

- 向量 **1 — 范数**：向量元素的绝对值之和。
    - $latex \lVert V \rVert _1 = \sum_{i=1}^{n} \lvert v_i \rvert$
- 向量 **2 — 范数**：向量元素平方和的平方根。
    - $latex \lVert V \rVert _2 = \sqrt{\sum_{i=1}^{n} v_i^2}$
- 向量 **$latex \infty $ — 范数**：所有向量元素绝对值中的最大值。
    - $latex \lVert V \rVert _\infty = \max_{1 \le i \le n} \left\{ \lvert v_i \rvert \right\}$

调用格式：

- `norm(V)` 或 `norm(V, 2)`：计算向量 V 的 2 — 范数。
- `norm(V, 1)`：计算向量 V 的 1 — 范数。
- `norm(V, inf)`：计算向量 V 的 $latex \infty $ — 范数。

矩阵的 3 种常用范数：

- 矩阵 **1 — 范数**：矩阵列元素绝对值之和的最大值。
    - $latex \lVert A \rVert _1 = \max_{1 \le j \le n} \left\{ \sum_{i=1}^{n} \lvert a_ij \rvert \right\}$
- 矩阵 **2 — 范数**：$latex A'A $ 矩阵的最大特征值的平方根。
    - $latex \lVert A \rVert _2 = \sqrt{\lambda_1}$
    - 其中 $latex \lambda_1 $ 为 $latex A'A $ 的最大特征值。
- 矩阵 **$latex \infty$ — 范数**：所有矩阵行元素绝对值之和的最大值。
    - $latex \lVert A \rVert _\infty = \max_{1 \le i \le m} \left\{ \sum_{j=1}^{n} \lvert a_ij \rVert \right\}$

> 调用格式与上面的格式完全相同。

### 矩阵的条件数

矩阵的条件数用于描述矩阵的性能的一个参数。

矩阵 A 的条件数等于 A 的范数与 A 的逆矩阵的范数的乘积。
条件数越接近于 1，矩阵的性能越好，反之越差。

矩阵 A 的 3 的条件数：

- `cord(A, 1)`：计算 A 的 1 — 范数下的条件数。
- `cord(A, 2)`：计算 A 的 2 — 范数下的条件数。
- `cord(A, inf)`：计算 A 的 $latex \infty $ — 范数下的条件数。

## 矩阵的特征值与特征向量

设 A 是 n 阶方阵，如果存在常数 $latex \lambda$ 和 n 维非零列向量 x，使得等式 **$latex Ax = \lambda x$** 成立，则称 $latex \lambda$ 为 A 的 **特征值**，x 是对应特征值 $latex \lambda$ 的 **特征向量**。

- `E = eig(A)` ：求矩阵 A 的全部特征值，构成向量 E.
- `[X, D] = eig(A)`：求矩阵 A 的全部特征值。
    - 构成对角阵 D，并产生矩阵 X，X 的各列是相应的特征向量。

特征值的几何意义：将原向量 x 进行 $latex \lambda $ 倍的伸缩变换。

> 使用 `eigshow()` 函数演示单位圆上的向量 x 和 Ax 之间的关系。
> x 与 Ax 共线时称为特征方向，存在 $latex Ax = \lambda x $。

## 稀疏矩阵

**稀疏矩阵** 是指矩阵中零元素的个数远远多于非零元素的个数的矩阵。

- **完全存储方式** 是将矩阵的全部元素按列存储。
- **稀疏存储方式** 只存储矩阵的非零元素的位置及其值。

> 当采用稀疏存储方式时，矩阵元素的存储顺序并没有改变，也是按列的顺序进行存储。

**完全存储方式与稀疏存储方式之间的转化：**

- `sparse(A)`：将完全存储方式转换为稀疏存储方式。
- `full(A)`：将稀疏存储方式转换为完全存储方式。

**直接建立稀疏存储矩阵：**

- `sparse(m, n)`：生成一个 m &times; n 的所有元素都是 0 的稀疏矩阵。
- `sparse(u, v, S)`
    - `u`、`v`、`S` 是 3 个等长的向量。
    - `S` 是要建立的稀疏矩阵的非零元素。
    - `u(i)`、`v(i)` 分别是 `S(i)` 的行下标和列下标。
- `B = spconvert(A)`
    - A 为 m &times; 3 或 m &times; 4 的矩阵，每行表示一个非零元素，m 是非零元素的个数。
    - `A(i, 1)` 表示第 i 个非零元素所在的行。
    - `A(i, 2)` 表示第 i 个非零元素所在的列。
    - `A(i, 3)` 表示第 i 个非零元素所在的实部。
    - `A(i, 4)` 表示第 i 个非零元素所在的虚部。
    - 若矩阵的全部元素都是实数，则忽略第四列。

**带状稀疏矩阵的稀疏存储**

稀疏矩阵有两种基本类型：*无规则结构的稀疏矩阵* 和 *有规则结构的稀疏矩阵*。
**带状稀疏矩阵** 是指所有非零元素集中在对角线上的矩阵。

- `[B, d] = spdiags(A)`：从带状稀疏矩阵 A 中提出全部非零对角线元素赋给矩阵 B 及其这些非零对角线的位置向量 d。
- `A = spdiags(B, d, m, n)`：产生带状系数矩阵的稀疏存储矩阵 A。
    - m、n 为原带状稀疏矩阵的行数与列数。
    - 矩阵 B 的第 i 列即为原带状稀疏矩阵的第 i 条非零对角线。
    - 向量 d 为原带状稀疏矩阵所有非零对角线的位置。

**单位矩阵的稀疏存储**

- `speye(m, n)`：产生一个 m &times; n 的稀疏存储单位矩阵。

> 当参与运算的数据对象不全是稀疏存储矩阵时，运算结果为完全存储矩阵。
