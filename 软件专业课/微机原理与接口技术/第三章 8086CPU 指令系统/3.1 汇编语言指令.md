[toc]

## 汇编语言与机器语言的相关概念

- 完成某个加法功能
	- 高级语言:采用语句 X=A+B，只要给变量 A 和 B 赋一确定值，此加法就可以实现了。
	- 汇编语言:程序必须指出 A、B 存放在何处，结果又存放在何处，然后才能实现这一运算。

### 机器语言

- 机器（CPU）能 **直接认识** 的一种 **二进制** 代码语言。
- CPU能认识的一组二进制代码就是一条指令。

- 机器语言程序
	- 采用机器语言编写的程序，即二进制代码程序。
	- 优点：程序送入计算机后，CPU 可以直接执行。
	- 缺点：不易书写，不易检查，编写程序十分困难。

### 汇编语言

- 采用一组字母、数字和符号来代替一条二进制代码指令，这种表示指令的符号称为 **助记符**。
- 用一组符号来代替一条指令编写程序时采用的语言，称为 **汇编语言**。
- 优点：要比一串二进制代码清晰多了，书写容易，记忆也方便。
- 缺点：CPU 不能直接执行。
	- 用汇编语言编写的 **汇编语言源程序** 必须经过 **汇编** ，将其翻译成机器语言格式，CPU 才能执行。

## 汇编语言程序中语句的种类

- 指令语句
	- 汇编后能产生机器语言代码，是 CPU 能执行的语句。
- 伪指令语句
	- 汇编后不能产生机器语言代码，是 CPU 不能执行的语句。
- 宏指令语句
	- 用户自己定义的一条能完成某一特定功能的新的指令。

### 汇编语言中语句的组成

`[标识符] 操作助记符 [操作数][;注释]`

- 操作助记符指出该条语句的基本操作功能，是必须有的。
- 中括号内可有可无。
- 每条语句可以有名称，也可以没有名称。
	- 标号：当语句中名称与操作助记符之间以 **冒号 `:`** 间隔时，该名称表示 **标号**，用于表示指令的地址。
	- 变量名：当语句中名称与操作助记符之间以 **空格 ` `** 间隔时，该名称表示 **变量名**，用于表示存放数据的存储空间。

> 若是指令语句，标识符就是一个标号名，以冒号结尾。
  若是伪指令语句，标识符就是变量名或者段名等，以空格结尾。

- 标识符命名规则
	- 第一个字符必须是字母，不能为数字。
	- 总字符个数不能超过 31 个。
	- 不能用 8086 指令系统中的专用符来给标识符起名称。

### 汇编语言中的常数与表达式

语句中的操作数项既可以是　**常数或表达式（立即数）**，也可以是指明操作数所在处的一种说明。

- 数值常数
	- 二进制数
	- 十进制数
	- 十六进制数
		- 第一个字符必须是 **数字**。
		- 如果以字母开头，则应该在其前面添加 **0**。
- 字符串常数
	- 字符串常数是由单引号 **`''`** 括起来的一串字符。
- 表达式
	- 由 **操作数** 和 **操作符** 组成。
	- 操作数可以是常数、标识符、表达式(子表达式)

|操作符|符号|
|-|-|
|算术操作符|`+` `-` `*` `/` `MOD`|
|逻辑操作符|`ADD` `OR` `XOR` `NOT`|
|关系操作符|`EQ`相等 `NE`不等 `LT`小于 `GT`大于 `LE`小于等于 `GE`大于等于|
|属性操作符|`SEG`段地址 `OFFSET`偏移地址 `TYPE`类型 `LENGTH`长度 `SIZE`大小|
|属性修改操作符|`PTR`|

- 逻辑操作符
	- 针对位。
	- 当出现在操作数中时，它才是操作符。
- 关系操作付
	- 若关系 **成立**，则为 **真**，取值全 **1**，结果为 **-1**。
	- 若关系 **不成立**，则为 **假**，取值全 **0**。

### 标号、变量及伪指令

#### 标号

标号是由指令语句中所定义的标识符，它与操作助记符用 **冒号** 间隔。

标号具有 3 个属性：

- 段地址：指示标号所在段的段地址。
- 偏移地址：只是标号在段内的偏移地址。
- 类型
	- 如果标号仅在本段内使用，则其类型为 **近程 `NEAR`**。
	- 如果标号在段间使用，则其类型为 **远程 `FAR`**。

#### 变量

变量定义：变量必须首先进行定义，然后才能使用。

- 变量是有伪指令来定义的。
- 格式：

```
变量名 DB 表达式 ; 定义字节变量，即 8 位（1 字节）变量
变量名 DW 表达式 ; 定义字变量，即 16 位（2 字节）变量
变量名 DD 表达式 ; 定义双字变量，即 32 位（4 字节）变量
变量名 DQ 表达式 ; 定义长字变量，即 64 为（8 字节）变量
变量名 DT 表达式 ; 定义一个 10 字节的变量
```

> 说明：
  1. 变量名与操作助记符 DB / DW / DD / DQ / DT 之间用空格。
	2. 变量名可有可无。
	3. 变量的类型与关键字 DB / DW / DD / DQ / DT 有关。

- 表达式有下列四种情况：
	- 一个、多个常数或表达式，它们之间用 **逗号 `,`** 间隔。
	- 带单引号的字符串。
		- 将每个字符的 ASCII 码存储在存储空间中。
	- 一个、多个 **问号 `?`**，这是表示 **只给变量分配存储空间**。
	- 重复方式
		- 格式为 `重复次数 DUP (表达式)`
	- `$` 符号
		- 预定义符号。
		- 出现在表达式中时，表示当前汇编语句的 **偏移地址**。
		- 出现在 DOS 功能调用显示字符串中是，表示所显示字符串的结束符。

---

 例：
```
ORG 1000H ; 指定段地址为 1000H
VAR1 DB 12H,0A5H,18+20,50/3,0,-1
VAR2 DW 12H,$+1
VAR3 DD 12345678H
VAR4 DB 'ABC'
		 DW 'AB'
VAR5 DB ?,?
VAR6 DB 4 DUP (OFFH,?)
VAR7 DB 3 DUP (55H,2 dup(77H))
```

解析：（参考下面存储分配图）
1. `DB` 伪指令可以依次存储多个数值。
2. `DW` `DD` 伪指令定义时，不足一个字时高位补 0。
3. `DW` `DD` 存储时数据高位存储在高地址，数据低位存储在低地址。

变量的存储分配图

|变量名|偏移地址|数据|变量名|偏移地址|数据|
|-|-|-|-|-|-|
|VAR1|0000H|12H|VAR5|0013H|?|
| | |0A5H| | |?|
| | |26H|VAR6|0015H|0FFH|
| | |10H| | |？|
| | |0| | |0FFH|
| | |0FFH| | |?|
|VAR2|0006H|12H| | |0FFH|
| | |0| | |?|
| | |09H| | |0FFH|
| | |0| | |?|
|VAR3|000AH|78H|VAR7|01DH|55H|
| | |56H| | |77H|
| | |34H| | |77H|
| | |12H| | |55H|
|VAR4|000EH|41H| | |77H|
| | |42H| | |77H|
| | |43H| | |55H|
| | |42H| | |77H|
| | |41H| | |77H|

---

- 变量属性
	- 段地址：指示变量所在段的段地址。
	- 偏移地址：变量所在段内的偏移地址。
	- 类型：表示变量的类型，不同类型所占字节大小不同。
		- 字节型 `BYTE` **1**
		- 字型 `WORD` **2**
		- 双字型 `DWORD` **4**
	- 长度：第一个 `DUP` 前的系数，表示变量的次数。
	- 大小：变量所占用的总子姐姐数。

- 伪指令 `DW` `DD` 特殊用法
	- `变量名1 DW 变量名2 ± 常数`
		- 变量名1 内存储 **变量名2 的偏移地址 ± 常数** 的结果。
	- `变量名1 DD 变量名2 ± 常数`
	 	- 低位字存放 **变量名2 的偏移地址 ± 常数** 的结果。
		- 高位字存放 **段地址** 的结果。

### 属性操作符和 PTR 操作符

- `SEG` 获取变量的段地址。
- `OFFSET` 获取变量的偏移地址。
- `TYPE` 获取变量的类型。
	- 字节型 `BYTE` **1**
	- 字型 `WORD` **2**
	- 双字型 `DWORD` **4**
- `LENGTH` 获取变量长度。
	- 第一个 `DUP` 前的系数表示变量重复的次数或长度。
	- 没有出现 `DUP` 或者第一个为数据时，长度为 **1**。
- `SIZE` 获取变量的大小。
	- 等于 `TYPE` * `LENGTH`。
- `PTR` **暂时** 改变已经定义过的变量或标号的类型。
	- 格式：`类型 PTR 表达式`
