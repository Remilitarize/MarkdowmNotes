[toc]

**系统体系结构** 用来描述系统各部分的结构、接口以及它们用于通信的机制。

## 系统体系结构模型

UML 提供两种系统体系结构描述图：**构件图** 和 **配置图**。

- **构件图** 描述系统中的不同物理构件及其相互之间的联系，表示系统代码本身的结构。
- **配置图** 描述系统软件构件与硬件之间的关系，表示运行时的系统结构。

系统体系结构建模可分为 **软件系统体系结构建模** 和 **硬件系统体系结构建模**。

- **软件系统体系结构建模** 就是对系统的用例、类、对象、接口以及相互间的交互和协作进行描述。
- **硬件系统体系结构建模** 则是要对系统的构件、结点和配置进行描述。

### 软件系统体系结构模型

在 UML 中使用了 **包** 的机制。
一个包相当于一个子系统。

软件系统体系结构模型的作用：

- 指出系统应该具有的功能。
- 完成这些功能将设计哪些类，这些类之间如何相互联系。
- 类和它们的对象如何协作才能实现这些功能。
- 指明系统中各功能实现的先后时间顺序。
- 根据软件系统体系结构模型，制订出相应的开发进度计划。

通用三层软件（逻辑）系统体系结构：

- **通用接口界面层**
    - 功能：设置连接该软件系统的运行环境的借口界面和设置本系统用户窗口使用的借口界面以及支持系统。
- **系统业务对象层**
    - 功能：设置用户窗口与系统各种实现具体功能服务的接口界面的连接，通过对系统的业务对象的有效管理，形成能实现系统功能的实际的业务对象集。
- **系统数据库**
    - 功能：将能实现系统功能的对象集作为持久对象及数据存储在磁盘中，便于系统在需要时再将这些持久对象和数据提取出来进行处理和操作。

### 硬件系统体系结构模型

硬件系统体系结构模型的作用：

- 指出系统中的类和对象设计的具体程序或进程。
- 标明系统中配置的计算机和其他硬件设备。
- 指出系统中各种计算机和硬件设备如何进行相互连接。
- 明确不同代码文件之间的相互依赖关系。
- 如果修改某个代码文件，标明哪些相关（与之有依赖关系）的代码文件需要重新进行编译。

## 软件系统体系结构建模

![构件图](http://oxnec2zdn.bkt.clouddn.com/UMLxitongjianmo/goujiantu.PNG)

### 软件构件的图符表示和特点

![构件图符](http://oxnec2zdn.bkt.clouddn.com/UMLxitongjianmo/goujiantutufu.PNG)

**构件图符** 是由一个 **矩形方框** 和嵌在 **左边框线上的两个小矩形框** 组成的。

- 每一个构件必须有一个有别于其他构件的名称。
- 只有单独一个名称的称为 **简单名**，在简单名前加上构件所在包的名称叫做 **路径名**。
- 构件中可以包含 **类**。
- 构件可以有 **实例**。

构件与类的比较：

- 相同点
    - 二者都有名称。
    - 都可以实现一组接口。
    - 都可以参与依赖、继承、关联等关系和交互。
    - 都可以被嵌套。
    - 都可以有实例。
- 不同点
    - 抽象方式不同。
        - 构件是 **程序代码的物理抽象**，可以驻留在结点上。
        - 类是 **逻辑抽象**，不能单独存在于结点上。
    - 抽象级别不同。
        - 构件表示一个物理模块，**可以包含多个类，并依赖它所包含的类**。
        - 类表示一个逻辑模块，**只能从属于某个构件，并通过构件来实现**。
    - 访问方式不同。
        - 构件不直接拥有属性和操作，**只能通过接口访问其操作**。
        - 类直接拥有自己的属性和操作，**可以直接访问其操作**。
    - 与包的关系不同。
        - 包可以包含成组的逻辑模型元素，也 **可以包含物理的构件**。
        - 一个类可以出现在多个构件中，却 **只能在一个包内定义**。

构件的特点：

- 接口：接口用来描述一个构件能提供服务的操作。
- 操作：构件通过消息传递方式进行操作，每个操作由输入输出变量、前置条件和后置条件来决定。
- 实例化：构件是一个物理实体，实例化代表运行期间的可执行软件模块。
- 与配置环境的亲和性。
    - 外部：利用配置环境提供的某族操作，可降低构件的复杂程度。
    - 内部：构件提供一组其配置环境需要的操作，达到亲和的目的。
- 能与同环境下的其他构件进行交互。可以调用其他构件和被其他构件发现和使用。
- 构件可以是可执行代码、二进制代码和源代码形式。
- 可替换的物理实体。构件是物理的实体而不是逻辑概念，具有可替换性。
- 系统的组成部分。构件是系统的一部分，很少独立存在，可在多个系统中复用。
- **构件是软件复用的基本单元。**

构件的组织形式：

- 用 **包** 来组织构件。
- 用构件之间的 **交互关系** 来组织构件。

### 构件的分类

在 UML 中，软件构件分为 **源代码构件**、**二进制代码构件** 和 **可执行代码构件**。

- 源代码构件也称 **编译时构件**。
    - `<<file>>` 表示包含源代码或数据的文件。
    - `<<page>>` 表示 Web 页。
    - `<<document>>` 表示文档。
- 二进制构件也称 **连接时构件**。
    - `<<library>>` 用来指出构件是静态库或动态库。
- 可执行构件也称 **运行时构件**。
    - `<<aplication>>` 表示一个可执行程序。
    - `<<table>>` 表示一个数据库表。

> 构件图显示的只有构件，而配置图中必须使用 **构件的实例**，且可执行构件的实例被分配到执行它们的结点上。

### 构件的接口

- **输出接口**：构件实现接口，即构件被使用的接口。
    - 一个构件可有多个输出接口。
- **输入接口**：构件使用的接口，即使用其他构件的接口。
    - 构件必须遵从该接口并以此为基础来构造构件。
    - 一个构件可遵从多个输入接口。

接口位于两个构件之间，割断了它们之间的依赖关系，使构件具有极好的封装性。

### 构件图建模步骤

- **确定构件**
    - 系统组成结构
    - 软件复用
    - 物理结点配置
    - 系统归并
    - 确定构件成份
- **说明构件**：使用 **构造型** 来说明。
- **标识构件之间的联系**
- **组织构件**

### 构件图建模的方法和技巧

**构件** 是系统中遵从一组接口并提供实现的一个物理的、可替换的单元。

一个结构良好的构件应具备的特点：

- 从物理结构上对软件系统进行抽象。
- 提供一组小的、定义完整的接口实现。
- 构件应包含与其功能有关的一组类，以便满足接口要求。
- 与其他构件相对独立，构件之间一般只有依赖和实现的关系。

在 UML 中绘制一个构件时应掌握的技巧：

- 为构件标识一个能准确表达其意义的名字。
- 只在必须显示接口的操作时才用长式表达。
- 只显示那些对理解构件功能有重要影响的接口。
- 构件为源代码或库时，注意显示有关版本标记。

一个结构良好的构件图应具备的特点：

- 侧重描述系统静态视图的某一侧面。
- 只包含哪些对描述该侧面内容有关的模型元素。
- 提供与抽象层次一致的描述，只显示有助于理解该构件图的必要的修饰。
- 图形不要过于简化，以防产生误解。

绘制一个构件图时应注意的问题：

- 为构件图标识一个能准确表达其意义的名字。
- 摆好各个构件的位置，尽量避免连接线的交叉。
- 语义相近的模型元素尽量靠近。
- 用注解和颜色提示重点部位。
- 谨慎采用自定义构造型元素。
- 采用尽量少的图符标记描述构件图，保持所有构件图风格一致。

## 硬件系统体系结构建模

组成配置图的基本元素有 **结点、构件、对象、连接、依赖** 等。

一个单机系统只需建立 *包图* 或 *构件图* 就可以。
配置图主要用于在网络环境下运行的分布式系统后嵌入式系统的建模。

### 配置图的基本元素——结点

![结点](http://oxnec2zdn.bkt.clouddn.com/UMLxitongjianmo/jiedian.PNG)

**结点** 既可看作类型，也可看作实例。

- 当结点被看作实例时，结点名应有下划线。
- 结点的图符用 **三维立方体** 表示。
- 图符有两种：**短式**、**长式**。
    - 必须有一个名字，写在立方体中间。
    - 短式图符一般只写简单结点名称，也可以写成路径名。
        - 路径名的双冒号前面指的是所在包名。
        - *结点名在其所在的包内具有唯一性。*
    - 使用 `{}` 围起的标记值说明该结点的性质。
    - 还可以附加构造型表示特定的设备类型。
    - 长式图符分为三部分：**结点名称、描述结点的属性、该结点上的构件**。

### 配置图中的构件

**可执行构件实例** 可以包含在配置图中的 **结点实例图形符号** 中。
表示它们在该结点实例上驻留并执行。

![包含构件的配置图](http://oxnec2zdn.bkt.clouddn.com/UMLxitongjianmo/baohangoujiandepeizhitu.PNG)

> 实例结点的名称后面带有冒号时，冒号后面的部分表示该实例所属的结点类型。

### 配置图中的对象

一个对象可以画在配置图中的结点实例中。
表示驻留在该结点上。
还可以用嵌套的方式把对象画在一个构件实例中或另一个对象中。

![包含对象的配置图](http://oxnec2zdn.bkt.clouddn.com/UMLxitongjianmo/baohanduixiangdepeizhitu.PNG)

构件和对象的实例可以驻留在结点上，还可以从一个结点向另一个节点 *迁移*。

- 一个结点可以和其他结点、构件、对象有关联。
- 结点也可以通过打包来组织节点，以便清晰描述系统体系结构的层次关系。

### 结点之间的关联

结点与结点之间通过 *物理连接* 发生联系，以便从硬件方面保证系统各结点之间的协同运行。
结点之间、结点与构件之间的联系包括 **通信关联、依赖联系** 等。

- 结点通过通信关联相互连接。
- 用一条 **直线** 表示。
- 可附加诸如 `<<TCP/IP>>` 或 `<<Ethernet>>` 等符号指明遵循的通信协议。

![通信关联](http://oxnec2zdn.bkt.clouddn.com/UMLxitongjianmo/tongxinguanlian.PNG)

结点与构件之间，驻留在某一个结点上的构件或对象与另一个结点上的构件或对象之间也可以发生联系，这种联系称为 **依赖**。

- 依赖有两种：
    - 同一结点上构件与节点的 **支持依赖**。
        - 使用构造型 `<<支持>>` 声明。
    - 分布式系统中不同结点上驻留构件或对象之间迁移的 **成为依赖**。
        - 使用构造型 `<<becomes>>` 声明。
- 构件用 **虚箭线** 表示。

### 配置图建模步骤

- 确定结点
- 确定驻留构件
- 注明结点性质
- 确定结点之间的联系
- 绘制配置图
