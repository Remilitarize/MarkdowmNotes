[toc]

- 关系数据库是支持**关系模型**的数据库系统。
- 关系数据结构：**二维表**
- 关系操作：**集合的操作方式**
	- 关系代数
	- SQL
	- 关系演算
- 关系的三种完整性约束
	- **实体完整性约束**
	- **参照完整性约束**
	- **用户自定义的完整性约束**

## 关系及相关概念

### 域

一组具有 **相同数据类型** 的值的集合。

### 笛卡儿积

给定一组域 D<sub>1</sub>, D<sub>2</sub>, ... , D<sub>n</sub> 的笛卡儿积为：
D<sub>1</sub> × D<sub>2</sub> × ... × D<sub>n</sub> = {d<sub>1</sub>, d<sub>2</sub>, ..., d<sub>n</sub> | d<sub>i</sub> &isin; D<sub>i</sub>, i = 1, 2, ..., n}

- 每个元素 (d<sub>1</sub>, d<sub>2</sub>, ... , d<sub>n</sub>)称作一个 **元组**。
- 元祖中的每一个值 d<sub>i</sub> 叫做一个 **分量**。
- 基数：集合中元素的个数。
- 若 D<sub>i</sub> 的基数为 m<sub>i</sub>，则笛卡儿积的基数为&Pi;<sub>i = 1</sub><sup>n</sup> m<sub>i</sub>。

> 例：
 假设给出两个域
 D<sub>1</sub> = {a, b},
 D<sub>2</sub> = {c, d}
 D<sub>1</sub> × D<sub>2</sub> = {(a, c), (a, d), (b, c), (b, d)}

### 关系

- 关系是笛卡尔积中 **有意义** 的 **子集**，所以关系也可以表示为 **二维表**。
- **n 目关系必有 n 个属性。**
	- 目：关系中 **属性的个数**。
- 关系的表示：关系名（属性名1，属性名2，...，属性名n）
- 类型：
	- 基本关系：实际存在的表。
	- 查询表：查询结果对应的表。（虚表）
	- 视图表：由基本表或其他视图导出来的表。（虚表）
- 性质
	- 每一列中的分量来自同一域，是同一类型的数据。
	- 不同的列可来自同一个域，但每列必须有 **不同的属性名**。
	- 行列的顺序无关紧要。
	- 任意两个元组不能完全相同。
	- 每一分量必须是 **不可再分** 的数据。
		- 关系数据库必要条件

### 候选键

- 关系中的一个属性（组），其值能 **唯一标识** 一个元组。若从属性（组）中 **去掉任何一个** 属性，它就 **不具有这一性质** 了，这样的属性（组）称作 **候选键**。
- 能 **唯一标识** 一个元组 **最小** 的属性组。

> 例：
 学生（**学号**，姓名，年龄，班级）
 选课关系（**学号**，**课程号**，上课地点，成绩）

一个关系的候选键可以有多个。

> 例：
 学生（学号，姓名，年龄，班级，专业）。
 假设：
 1. 每个班级不能有重名的学生；
 2. 同一专业允许学生重名。

> 则学生关系的候选键有
- 学号
- 姓名，班级，专业

### 主键

如果一个关系有多个候选键，则选定 **其中的一个** 作为主键。

### 主属性

**候选键** 中 **每个属性** 都是 **主属性**。

## 关系模式

- 关系的描述称为 **关系模式**。
- 表示：R（U, D, DOM, F）
	- R：关系名
	- U：属性名的集合
	- D：属性集 U 中所有属性来自的域
	- DOM：属性向域的映射集合
	- F：属性间数据的依赖关系
- 通常记作：**R（U）**

### 关系模式与关系

- 关系模式是 **静态的**、**稳定的**
- 关系是 **动态的**、**随时间不断变化的**
- 关系是关系模式在某一时刻的状态与内容。

### 型和值

- 型
	- 也称关系数据库模式，是对关系数据库的描述。
	- 包括若干域以及在这些域上定义的若干关系模式。
- 值
	- 关系模式在某一时刻对应的关系的集合。

## 关系的完整性

为了维护数据库中数据与现实世界的 **一致性**，对关系数据库的插入、删除和修改操作必须有 **一定的约束条件**，这就是关系模型的完整性。

- **实体完整性**
- **参照完整性**
- **用户自定义的完整性**

> 实体完整性和参照完整性又称为 **两个不变性**。

### 实体完整性

规则：

- 若属性 A 是基本关系 R 的 **主属性**，则属性 A 不能取 **空值**。

> 例：
 选课关系（学号，课程编号，成绩，上课地点）
 则主属性：学号、课程编号均不能取空值

### 参照完整性

现实世界中的实体之间往往存在某种联系，在关系模型中实体及实体间的联系都是用关系来描述的。这样就自然存在着 **关系与关系间的引用**。

> 例1  ：
 学生（学号，姓名，性别，外语语种，**班级编号**）
 班级（**班级编号**，班级名称，辅导员编号，...）

> 例2 ：
 学生（**学号**，姓名，性别，...）
 课程（*课程号*，课程名，类别，学分）
 选课（**学号**，*课程号*，成绩，上课地点）

> 例3 ：
 学生（**学号**，姓名，性别，外语语种，班级编号，**班长学号**）

规则：

- 设 F 是基本关系 R 中的一个或一组属性，但 **不是关系 R 的主键**，如果 F 与基本关系 S 的 **主键 Ks 相对应**
- F 称是基本关系 R 的 **外键**。
- 基本关系 R 是 **参照关系**。
- 基本关系 S 是 **被参照关系**。

> 例1：
 学生（**学号**，姓名，性别，...）
 课程（*课程号*，课程名，类别，学分）
 选课（**学号**，*课程号*，成绩，上课地点）

 >选课关系的外键有 **学号和课程号**。
单独的学号和课程号都不是候选键。

 > 选课关系是参照关系。
 学生关系和课程关系是被参照关系。

> 例2：
 学生（**学号**，姓名，性别，外语语种，班级编号，**班长学号**）

> 班长学好是学生关系的外键。
 学生关系即使参照关系又是被参照关系。

### 用户自定义的完整性

- 针对某一具体关系数据库的约束条件，它反映某一**具体应用**所涉及的数据必须满足的语义要求。
