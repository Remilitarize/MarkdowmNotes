[toc]

## 表的创建与维护

### 使用 SSMS 图形化方式创建与维护表

略

### 使用 T-SQL 语句方式创建与维护表

#### 创建表

```sql
CREATE TABLE <表名>
(
	<列名 1 > <数据类型> <列级完整性约束>
	[, ..., n]
	<表级完整性约束>
	[, ..., n]
)
[ON <filegroup> | <"default">]
```

说明：

- <表名>：在当前数据库中新建的表的名称。
- `ON <filegroup> | <"default">`：指定存储表的文件组。

列级完整性约束：

- **默认值约束**：`[CONSTRAINT <默认值约束名>] DEFAULT 常量表达式`
- **空值 / 非空值约束**：`NULL | NOT NULL`
- **主键约束**：`[CONSTRANIT <主键约束名>] PRIMARY KEY [CLUSTERED | NONCLUSTERED]`
	- 其中 `CLUSTERED` 表示所创建的约束是聚集索引的。
	- 默认是 `CLUSTERED`。
- **外键约束**：`[CONSTRAINT <外键约束名>] [FOREIGN KEY] REFERENCES <父表名>[(<主键>)]`
- **唯一性约束**：`[CONSTRAINT <唯一性约束名>] UNIQUE [CLUSTERED | NONCLUSTERED]`
- **检查约束**：`[CONSTRAINT <检查约束名>] CHECK(<逻辑表达式>)`

表级完整性约束：

- `UNIQUE(列名 1, 列名 2, ..., 列名 n)`：多个列名 **单值约束**。
- `PRIMARY KEY(列名 1, 列名 2, ..., 列名 n)`：多个列名组合 **主键约束**。
- `FOREIGN KEY(外键) REFERENCES 主键表(主键)`：多个列名组合 **外键约束**。
- `CHECK(逻辑表达式)`：含有多个列名逻辑表达式的 **检查约束**。

#### 更改表结构

```sql
ALTER TABLE <表名>
[ALTER COLUMN <列名> <列定义>]
| [ADD <列名> <数据类型> <约束>[, ..., n]]
| [DROP COLUMN <列名>[, ..., n]]
| [ADD CONSTRAINT <约束名> <约束>[, ..., n]]
| [DROP CONSTRAINT <约束名>[, ..., n]]
```

说明：

- <表名>：要修改的表的名称。
- <列名>：要修改的字段名。
- `ALTER COLUMN`：修改列的定义子句。
- `ADD`：增加新列或约束子句。
- `DROP`：删除列火约束子句。

> 在标准的 SQL 中，每个 `ALTER TABLE` 语句中的每个字句只允许使用一次。

## 表中数据的维护

### 插入表数据

```sql
INSERT INTO <表名>[(<列名>[, ..., n])]
VALUES(<常量表达式> | NULL | DEFAULT[, ..., n])
```

说明：

- <表名>：要插入数据的表名称。
- <列名>：要插入数据所对应的字段名。
	- 如果向表中的所有列插入数据且字段顺序与表结构相同，则字段名可以省略。
- <常量表达式>：与列名对应的字段的值。
	- **字符型** 和 **日期型** 的值需要用 **单引号** 括起来，值与值之间用逗号隔开。

> `INSERT ... VALUES` 语句一次只能插入一行数据。

### 修改表数据

```sql
UPDATE <表名>
SET <列名> = <表达式>[, ..., n]
[WHERE <逻辑表达式>]
```

说明：

- <表名>：要修改数据的表名称。
- <列名>：要修改数据所对应的字段名。
- <表达式>：要修改的新值。
	- 如果新值 **违反了约束** 或 **与修改列的数据类型不兼容**，则取消该语句，并返回错误提示。
- <逻辑表达式>：更新条件。
	- 只有 **满足条件的记录** 才会被更新。
	- 如果不设置，则更新所有的记录。

### 删除表数据

```sql
DELETE FROM <表名>
[WHERE <逻辑表达式>]
```

说明：

- <表名>：要删除数据的表名称。
- <逻辑表达式>：删除条件。
	- 只有 **满足条件的记录** 才会被删除。
	- 如果不设置，则删除所有的记录。

## 数据库数据的导入与导出

略
